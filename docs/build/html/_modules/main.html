

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>main &mdash; nczarr-viewer 0.1.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=f9185e5b" />

  
    <link rel="canonical" href="/nczarr-viewer/_modules/main.html" />
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=01f34227"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="../_static/custom.js?v=eb49075c"></script>
      <script src="../_static/redirect.js?v=74cb3ab3"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #667eea" >

          
          
          <a href="../index.html" class="icon icon-home">
            nczarr-viewer
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../usage.html">Usage</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../usage.html#quick-start">Quick Start</a></li>
<li class="toctree-l2"><a class="reference internal" href="../usage.html#local-development">Local Development</a></li>
<li class="toctree-l2"><a class="reference internal" href="../usage.html#docker-deployment">Docker Deployment</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../usage.html#quick-docker-run">Quick Docker Run</a></li>
<li class="toctree-l3"><a class="reference internal" href="../usage.html#with-local-files">With Local Files</a></li>
<li class="toctree-l3"><a class="reference internal" href="../usage.html#with-online-datasets">With Online Datasets</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../usage.html#s3-cloud-storage-access">S3/Cloud Storage Access</a></li>
<li class="toctree-l2"><a class="reference internal" href="../usage.html#cmems-integration">CMEMS Integration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../usage.html#configuration">Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../usage.html#troubleshooting">Troubleshooting</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../dockerfile.html">Dockerfile</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api.html">API Reference</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../api.html#module-main">Core Modules</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../api.html#main.TimeoutException"><code class="docutils literal notranslate"><span class="pre">TimeoutException</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api.html#main.ViewerApp"><code class="docutils literal notranslate"><span class="pre">ViewerApp</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api.html#main.ViewerApp.get_metadata_summary"><code class="docutils literal notranslate"><span class="pre">ViewerApp.get_metadata_summary()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api.html#main.ViewerApp.run"><code class="docutils literal notranslate"><span class="pre">ViewerApp.run()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api.html#main.ViewerApp.setup_callbacks"><code class="docutils literal notranslate"><span class="pre">ViewerApp.setup_callbacks()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api.html#main.ViewerApp.setup_help_modal_callback"><code class="docutils literal notranslate"><span class="pre">ViewerApp.setup_help_modal_callback()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api.html#main.ViewerApp.setup_variable_metadata_callback"><code class="docutils literal notranslate"><span class="pre">ViewerApp.setup_variable_metadata_callback()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api.html#main.ViewerApp.update_variable_dropdown"><code class="docutils literal notranslate"><span class="pre">ViewerApp.update_variable_dropdown()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../api.html#module-data">Data Loading and Processing</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../api.html#data.DataManager"><code class="docutils literal notranslate"><span class="pre">DataManager</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api.html#data.DataManager.create_raster_image"><code class="docutils literal notranslate"><span class="pre">DataManager.create_raster_image()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api.html#data.DataManager.setup_callbacks"><code class="docutils literal notranslate"><span class="pre">DataManager.setup_callbacks()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api.html#data.DataPlot"><code class="docutils literal notranslate"><span class="pre">DataPlot</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api.html#data.DataPlot.setup_callbacks"><code class="docutils literal notranslate"><span class="pre">DataPlot.setup_callbacks()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api.html#data.DataQuickStats"><code class="docutils literal notranslate"><span class="pre">DataQuickStats</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api.html#data.DataQuickStats.setup_callbacks"><code class="docutils literal notranslate"><span class="pre">DataQuickStats.setup_callbacks()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api.html#data.DataSubsetter"><code class="docutils literal notranslate"><span class="pre">DataSubsetter</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api.html#data.DataSubsetter.subset_data"><code class="docutils literal notranslate"><span class="pre">DataSubsetter.subset_data()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api.html#data.DatasetLoader"><code class="docutils literal notranslate"><span class="pre">DatasetLoader</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api.html#data.DatasetLoader.clear_logs"><code class="docutils literal notranslate"><span class="pre">DatasetLoader.clear_logs()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api.html#data.DatasetLoader.get_logs"><code class="docutils literal notranslate"><span class="pre">DatasetLoader.get_logs()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api.html#data.DatasetLoader.load_dataset"><code class="docutils literal notranslate"><span class="pre">DatasetLoader.load_dataset()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api.html#data.DatasetLoader.setup_logging"><code class="docutils literal notranslate"><span class="pre">DatasetLoader.setup_logging()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../api.html#variable-and-dimension-handling">Variable and Dimension Handling</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../api.html#variables.VariableSelection"><code class="docutils literal notranslate"><span class="pre">VariableSelection</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api.html#variables.VariableSelection.setup_callbacks"><code class="docutils literal notranslate"><span class="pre">VariableSelection.setup_callbacks()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api.html#dimension.DimensionSelection"><code class="docutils literal notranslate"><span class="pre">DimensionSelection</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api.html#dimension.DimensionSelection.create_dropdown"><code class="docutils literal notranslate"><span class="pre">DimensionSelection.create_dropdown()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api.html#dimension.DimensionSelection.create_range_slider"><code class="docutils literal notranslate"><span class="pre">DimensionSelection.create_range_slider()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api.html#dimension.DimensionSelection.generate_dimension_checklist"><code class="docutils literal notranslate"><span class="pre">DimensionSelection.generate_dimension_checklist()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api.html#dimension.DimensionSelection.generate_dimension_controls"><code class="docutils literal notranslate"><span class="pre">DimensionSelection.generate_dimension_controls()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api.html#dimension.DimensionSelection.setup_callbacks"><code class="docutils literal notranslate"><span class="pre">DimensionSelection.setup_callbacks()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../api.html#main-application-class">Main Application Class</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: #667eea" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">nczarr-viewer</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content style-external-links">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">Module code</a></li>
      <li class="breadcrumb-item active">main</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for main</h1><div class="highlight"><pre>
<span></span><span class="kn">import</span><span class="w"> </span><span class="nn">dash</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">dash</span><span class="w"> </span><span class="kn">import</span> <span class="n">Dash</span><span class="p">,</span> <span class="n">html</span><span class="p">,</span> <span class="n">dcc</span><span class="p">,</span> <span class="n">Input</span><span class="p">,</span> <span class="n">Output</span><span class="p">,</span> <span class="n">State</span><span class="p">,</span> <span class="n">callback_context</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">dash_bootstrap_components</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">dbc</span>

<span class="c1"># Setup module for initialization tasks</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">setup</span><span class="w"> </span><span class="kn">import</span> <span class="n">setup_cartopy_data</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">variables</span><span class="w"> </span><span class="kn">import</span> <span class="n">VariableSelection</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">dimension</span><span class="w"> </span><span class="kn">import</span> <span class="n">DimensionSelection</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">data</span><span class="w"> </span><span class="kn">import</span> <span class="n">DataManager</span><span class="p">,</span> <span class="n">DatasetLoader</span>


<div class="viewcode-block" id="TimeoutException">
<a class="viewcode-back" href="../api.html#main.TimeoutException">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">TimeoutException</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
    <span class="k">pass</span></div>



<div class="viewcode-block" id="ViewerApp">
<a class="viewcode-back" href="../api.html#main.ViewerApp">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">ViewerApp</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">app</span> <span class="o">=</span> <span class="n">Dash</span><span class="p">(</span><span class="vm">__name__</span><span class="p">,</span> <span class="n">external_stylesheets</span><span class="o">=</span><span class="p">[</span><span class="n">dbc</span><span class="o">.</span><span class="n">themes</span><span class="o">.</span><span class="n">BOOTSTRAP</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">app</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">suppress_callback_exceptions</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ds</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dataset_engine</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dataseturl</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dataset_loader</span> <span class="o">=</span> <span class="n">DatasetLoader</span><span class="p">()</span>
        <span class="n">setup_cartopy_data</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">app</span><span class="o">.</span><span class="n">layout</span> <span class="o">=</span> <span class="n">dbc</span><span class="o">.</span><span class="n">Container</span><span class="p">([</span>
            <span class="n">dbc</span><span class="o">.</span><span class="n">Row</span><span class="p">([</span>
                <span class="n">dbc</span><span class="o">.</span><span class="n">Col</span><span class="p">(</span><span class="n">html</span><span class="o">.</span><span class="n">H1</span><span class="p">(</span><span class="s2">&quot;Zarr/NetCDF Data Viewer&quot;</span><span class="p">,</span>
                        <span class="n">className</span><span class="o">=</span><span class="s2">&quot;text-center mb-4&quot;</span><span class="p">),</span> <span class="n">width</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
            <span class="p">]),</span>
            <span class="c1"># Top row: Load Dataset and Variable Selection side by side</span>
            <span class="n">dbc</span><span class="o">.</span><span class="n">Row</span><span class="p">([</span>
                <span class="n">dbc</span><span class="o">.</span><span class="n">Col</span><span class="p">([</span>
                    <span class="n">dbc</span><span class="o">.</span><span class="n">Card</span><span class="p">([</span>
                        <span class="n">dbc</span><span class="o">.</span><span class="n">CardHeader</span><span class="p">(</span><span class="s2">&quot;Load Dataset&quot;</span><span class="p">),</span>
                        <span class="n">dbc</span><span class="o">.</span><span class="n">CardBody</span><span class="p">([</span>
                            <span class="n">html</span><span class="o">.</span><span class="n">Div</span><span class="p">([</span>
                                <span class="n">html</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="s2">&quot;Choose from predefined datasets:&quot;</span><span class="p">,</span>
                                           <span class="n">className</span><span class="o">=</span><span class="s2">&quot;mb-2&quot;</span><span class="p">,</span>
                                           <span class="n">style</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;fontWeight&quot;</span><span class="p">:</span> <span class="s2">&quot;bold&quot;</span><span class="p">}),</span>
                                <span class="n">dcc</span><span class="o">.</span><span class="n">Dropdown</span><span class="p">(</span>
                                    <span class="nb">id</span><span class="o">=</span><span class="s1">&#39;dataset-dropdown&#39;</span><span class="p">,</span>
                                    <span class="n">options</span><span class="o">=</span><span class="p">[</span>
                                        <span class="p">{</span>
                                            <span class="s2">&quot;label&quot;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;https://s3.waw3-1.cloudferro.com/&quot;</span>
                                                      <span class="s2">&quot;emodnet/emodnet_seabed_habitats/12548/&quot;</span>
                                                      <span class="s2">&quot;EUSeaMap_2023.zarr&quot;</span><span class="p">),</span>
                                            <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;https://s3.waw3-1.cloudferro.com/&quot;</span>
                                                      <span class="s2">&quot;emodnet/emodnet_seabed_habitats/12548/&quot;</span>
                                                      <span class="s2">&quot;EUSeaMap_2023.zarr&quot;</span><span class="p">)</span>
                                        <span class="p">},</span>
                                        <span class="p">{</span>
                                            <span class="s2">&quot;label&quot;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;https://s3.waw3-1.cloudferro.com/&quot;</span>
                                                      <span class="s2">&quot;emodnet/emodnet_arco/emodnet_chemistry/&quot;</span>
                                                      <span class="s2">&quot;water_body_dissolved_inorganic_nitrogen/&quot;</span>
                                                      <span class="s2">&quot;water_body_dissolved_inorganic_nitrogen_&quot;</span>
                                                      <span class="s2">&quot;masked_using_relative_error_threshold_0.5_&quot;</span>
                                                      <span class="s2">&quot;baltic_sea/Water_body_dissolved_inorganic_&quot;</span>
                                                      <span class="s2">&quot;nitrogen.4Danl.zarr&quot;</span><span class="p">),</span>
                                            <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;https://s3.waw3-1.cloudferro.com/&quot;</span>
                                                      <span class="s2">&quot;emodnet/emodnet_arco/emodnet_chemistry/&quot;</span>
                                                      <span class="s2">&quot;water_body_dissolved_inorganic_nitrogen/&quot;</span>
                                                      <span class="s2">&quot;water_body_dissolved_inorganic_nitrogen_&quot;</span>
                                                      <span class="s2">&quot;masked_using_relative_error_threshold_0.5_&quot;</span>
                                                      <span class="s2">&quot;baltic_sea/Water_body_dissolved_inorganic_&quot;</span>
                                                      <span class="s2">&quot;nitrogen.4Danl.zarr&quot;</span><span class="p">)</span>
                                        <span class="p">},</span>
                                        <span class="p">{</span>
                                            <span class="s2">&quot;label&quot;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;https://s3.waw3-1.cloudferro.com/&quot;</span>
                                                      <span class="s2">&quot;emodnet/emodnet_geology/12495/&quot;</span>
                                                      <span class="s2">&quot;EMODnet_Seabed_Substrate_1M.zarr&quot;</span><span class="p">),</span>
                                            <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;https://s3.waw3-1.cloudferro.com/&quot;</span>
                                                      <span class="s2">&quot;emodnet/emodnet_geology/12495/&quot;</span>
                                                      <span class="s2">&quot;EMODnet_Seabed_Substrate_1M.zarr&quot;</span><span class="p">)</span>
                                        <span class="p">},</span>
                                        <span class="p">{</span>
                                            <span class="s2">&quot;label&quot;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;https://s3.waw3-1.cloudferro.com/mdl-arco-geo-001/&quot;</span>
                                                      <span class="s2">&quot;arco/ARCTIC_MULTIYEAR_BGC_002_005/&quot;</span>
                                                      <span class="s2">&quot;cmems_mod_arc_bgc_my_ecosmo_P1M_202105/&quot;</span>
                                                      <span class="s2">&quot;geoChunked.zarr&quot;</span><span class="p">),</span>
                                            <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;https://s3.waw3-1.cloudferro.com/mdl-arco-geo-001/&quot;</span>
                                                      <span class="s2">&quot;arco/ARCTIC_MULTIYEAR_BGC_002_005/&quot;</span>
                                                      <span class="s2">&quot;cmems_mod_arc_bgc_my_ecosmo_P1M_202105/&quot;</span>
                                                      <span class="s2">&quot;geoChunked.zarr&quot;</span><span class="p">)</span>
                                        <span class="p">}</span>
                                    <span class="p">],</span>
                                    <span class="n">placeholder</span><span class="o">=</span><span class="s1">&#39;Select a dataset from the list&#39;</span><span class="p">,</span>
                                    <span class="n">style</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;width&#39;</span><span class="p">:</span> <span class="s1">&#39;100%&#39;</span><span class="p">},</span>
                                    <span class="n">clearable</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                    <span class="n">searchable</span><span class="o">=</span><span class="kc">True</span>
                                <span class="p">),</span>
                                <span class="n">html</span><span class="o">.</span><span class="n">Br</span><span class="p">(),</span>
                                <span class="n">html</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="s2">&quot;Or enter a custom URL:&quot;</span><span class="p">,</span>
                                           <span class="n">className</span><span class="o">=</span><span class="s2">&quot;mb-2&quot;</span><span class="p">,</span>
                                           <span class="n">style</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;fontWeight&quot;</span><span class="p">:</span> <span class="s2">&quot;bold&quot;</span><span class="p">}),</span>
                                <span class="n">dcc</span><span class="o">.</span><span class="n">Input</span><span class="p">(</span>
                                    <span class="nb">id</span><span class="o">=</span><span class="s1">&#39;dataset-url-input&#39;</span><span class="p">,</span>
                                    <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;text&#39;</span><span class="p">,</span>
                                    <span class="n">placeholder</span><span class="o">=</span><span class="s1">&#39;Enter custom dataset URL or path&#39;</span><span class="p">,</span>
                                    <span class="n">style</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;width&#39;</span><span class="p">:</span> <span class="s1">&#39;100%&#39;</span><span class="p">}</span>
                                <span class="p">),</span>
                                <span class="n">html</span><span class="o">.</span><span class="n">Div</span><span class="p">([</span>
                                    <span class="n">html</span><span class="o">.</span><span class="n">Small</span><span class="p">([</span>
                                        <span class="n">html</span><span class="o">.</span><span class="n">I</span><span class="p">(</span><span class="s2">&quot;ðŸ’¡ Tip: For netcdf files on s3 storage, add &quot;</span><span class="p">,</span>
                                               <span class="n">style</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="s2">&quot;#6c757d&quot;</span><span class="p">}),</span>
                                        <span class="n">html</span><span class="o">.</span><span class="n">Code</span><span class="p">(</span><span class="s2">&quot;#mode=bytes&quot;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;backgroundColor&quot;</span><span class="p">:</span> <span class="s2">&quot;#f8f9fa&quot;</span><span class="p">,</span> <span class="s2">&quot;padding&quot;</span><span class="p">:</span> <span class="s2">&quot;2px 4px&quot;</span><span class="p">,</span> <span class="s2">&quot;borderRadius&quot;</span><span class="p">:</span> <span class="s2">&quot;3px&quot;</span><span class="p">}),</span>
                                        <span class="n">html</span><span class="o">.</span><span class="n">I</span><span class="p">(</span><span class="s2">&quot; at the end of the URL to ensure proper data access.&quot;</span><span class="p">,</span>
                                               <span class="n">style</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="s2">&quot;#6c757d&quot;</span><span class="p">})</span>
                                    <span class="p">],</span> <span class="n">style</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;marginTop&quot;</span><span class="p">:</span> <span class="s2">&quot;5px&quot;</span><span class="p">,</span> <span class="s2">&quot;fontSize&quot;</span><span class="p">:</span> <span class="s2">&quot;12px&quot;</span><span class="p">})</span>
                                <span class="p">]),</span>
                                <span class="n">html</span><span class="o">.</span><span class="n">Br</span><span class="p">(),</span>
                                <span class="n">html</span><span class="o">.</span><span class="n">Br</span><span class="p">(),</span>
                                <span class="n">html</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="s2">&quot;Backend Selection:&quot;</span><span class="p">,</span>
                                           <span class="n">className</span><span class="o">=</span><span class="s2">&quot;mb-2&quot;</span><span class="p">,</span>
                                           <span class="n">style</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;fontWeight&quot;</span><span class="p">:</span> <span class="s2">&quot;bold&quot;</span><span class="p">}),</span>
                                <span class="n">dcc</span><span class="o">.</span><span class="n">Dropdown</span><span class="p">(</span>
                                    <span class="nb">id</span><span class="o">=</span><span class="s1">&#39;backend-dropdown&#39;</span><span class="p">,</span>
                                    <span class="n">options</span><span class="o">=</span><span class="p">[</span>
                                        <span class="p">{</span><span class="s2">&quot;label&quot;</span><span class="p">:</span> <span class="s2">&quot;Auto-detect&quot;</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="s2">&quot;auto&quot;</span><span class="p">},</span>
                                        <span class="p">{</span><span class="s2">&quot;label&quot;</span><span class="p">:</span> <span class="s2">&quot;xarray&quot;</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="s2">&quot;xarray&quot;</span><span class="p">},</span>
                                        <span class="p">{</span><span class="s2">&quot;label&quot;</span><span class="p">:</span> <span class="s2">&quot;Copernicus Marine&quot;</span><span class="p">,</span>
                                         <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="s2">&quot;copernicusmarine&quot;</span><span class="p">},</span>
                                    <span class="p">],</span>
                                    <span class="n">value</span><span class="o">=</span><span class="s2">&quot;auto&quot;</span><span class="p">,</span>
                                    <span class="n">style</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;width&#39;</span><span class="p">:</span> <span class="s1">&#39;100%&#39;</span><span class="p">}</span>
                                <span class="p">),</span>
                                <span class="n">html</span><span class="o">.</span><span class="n">Br</span><span class="p">(),</span>
                                <span class="n">html</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="s2">&quot;Backend Configuration (JSON):&quot;</span><span class="p">,</span>
                                           <span class="n">className</span><span class="o">=</span><span class="s2">&quot;mb-2&quot;</span><span class="p">,</span>
                                           <span class="n">style</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;fontWeight&quot;</span><span class="p">:</span> <span class="s2">&quot;bold&quot;</span><span class="p">}),</span>
                                <span class="n">html</span><span class="o">.</span><span class="n">Div</span><span class="p">([</span>
                                    <span class="n">html</span><span class="o">.</span><span class="n">A</span><span class="p">(</span><span class="s2">&quot;How to use kwargs&quot;</span><span class="p">,</span>
                                           <span class="n">href</span><span class="o">=</span><span class="s2">&quot;#&quot;</span><span class="p">,</span>
                                           <span class="nb">id</span><span class="o">=</span><span class="s2">&quot;help-link&quot;</span><span class="p">,</span>
                                           <span class="n">style</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="s2">&quot;#007bff&quot;</span><span class="p">,</span> <span class="s2">&quot;textDecoration&quot;</span><span class="p">:</span> <span class="s2">&quot;underline&quot;</span><span class="p">}),</span>
                                    <span class="n">html</span><span class="o">.</span><span class="n">Span</span><span class="p">(</span><span class="s2">&quot; - Click for examples&quot;</span><span class="p">,</span>
                                              <span class="n">className</span><span class="o">=</span><span class="s2">&quot;text-muted&quot;</span><span class="p">,</span>
                                              <span class="n">style</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;fontSize&quot;</span><span class="p">:</span> <span class="s2">&quot;12px&quot;</span><span class="p">})</span>
                                <span class="p">],</span> <span class="n">className</span><span class="o">=</span><span class="s2">&quot;mb-2&quot;</span><span class="p">),</span>
                                <span class="n">dcc</span><span class="o">.</span><span class="n">Textarea</span><span class="p">(</span>
                                    <span class="nb">id</span><span class="o">=</span><span class="s1">&#39;additional-params-input&#39;</span><span class="p">,</span>
                                    <span class="n">placeholder</span><span class="o">=</span><span class="s1">&#39;{&quot;backend&quot;: &quot;xarray&quot;, &quot;engine&quot;: &quot;zarr&quot;, &quot;chunks&quot;: {&quot;time&quot;: 1}}&#39;</span><span class="p">,</span>
                                    <span class="n">style</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;width&#39;</span><span class="p">:</span> <span class="s1">&#39;100%&#39;</span><span class="p">,</span> <span class="s1">&#39;height&#39;</span><span class="p">:</span> <span class="s1">&#39;80px&#39;</span><span class="p">}</span>
                                <span class="p">),</span>
                                <span class="c1"># Help modal content (hidden by default)</span>
                                <span class="n">dbc</span><span class="o">.</span><span class="n">Modal</span><span class="p">([</span>
                                    <span class="n">dbc</span><span class="o">.</span><span class="n">ModalHeader</span><span class="p">(</span><span class="n">dbc</span><span class="o">.</span><span class="n">ModalTitle</span><span class="p">(</span>
                                        <span class="s2">&quot;How to use Backend Configuration&quot;</span><span class="p">)),</span>
                                    <span class="n">dbc</span><span class="o">.</span><span class="n">ModalBody</span><span class="p">([</span>
                                        <span class="n">html</span><span class="o">.</span><span class="n">H6</span><span class="p">(</span><span class="s2">&quot;xarray Backend Examples:&quot;</span><span class="p">),</span>
                                        <span class="n">html</span><span class="o">.</span><span class="n">Pre</span><span class="p">(</span><span class="s1">&#39;&#39;&#39;</span>
<span class="s1">{</span>
<span class="s1">  &quot;backend&quot;: &quot;xarray&quot;,</span>
<span class="s1">  &quot;engine&quot;: &quot;zarr&quot;,</span>
<span class="s1">  &quot;chunks&quot;: {&quot;time&quot;: 1},</span>
<span class="s1">  &quot;decode_timedelta&quot;: true</span>
<span class="s1">}</span>

<span class="s1">{</span>
<span class="s1">  &quot;backend&quot;: &quot;xarray&quot;,</span>
<span class="s1">  &quot;engine&quot;: &quot;netcdf4&quot;,</span>
<span class="s1">  &quot;chunks&quot;: {&quot;time&quot;: 1, &quot;lat&quot;: 100, &quot;lon&quot;: 100},</span>
<span class="s1">  &quot;decode_timedelta&quot;: false</span>
<span class="s1">}</span>

<span class="s1">{</span>
<span class="s1">  &quot;backend&quot;: &quot;xarray&quot;,</span>
<span class="s1">  &quot;engine&quot;: &quot;h5netcdf&quot;,</span>
<span class="s1">  &quot;chunks&quot;: {&quot;time&quot;: 1},</span>
<span class="s1">  &quot;decode_cf&quot;: true,</span>
<span class="s1">  &quot;mask_and_scale&quot;: true</span>
<span class="s1">}</span>
<span class="s1">                                         &#39;&#39;&#39;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;backgroundColor&quot;</span><span class="p">:</span> <span class="s2">&quot;#f8f9fa&quot;</span><span class="p">,</span> <span class="s2">&quot;padding&quot;</span><span class="p">:</span> <span class="s2">&quot;10px&quot;</span><span class="p">,</span> <span class="s2">&quot;borderRadius&quot;</span><span class="p">:</span> <span class="s2">&quot;4px&quot;</span><span class="p">}),</span>

                                        <span class="n">html</span><span class="o">.</span><span class="n">H6</span><span class="p">(</span>
                                            <span class="s2">&quot;Copernicus Marine Examples:&quot;</span><span class="p">),</span>
                                        <span class="n">html</span><span class="o">.</span><span class="n">Pre</span><span class="p">(</span><span class="s1">&#39;&#39;&#39;</span>
<span class="s1">{</span>
<span class="s1">  &quot;backend&quot;: &quot;copernicusmarine&quot;,</span>
<span class="s1">  &quot;engine&quot;: &quot;copernicusmarinetoolbox&quot;,</span>
<span class="s1">  &quot;username&quot;: &quot;your_username&quot;,</span>
<span class="s1">  &quot;password&quot;: &quot;your_password&quot;,</span>
<span class="s1">  &quot;dataset_id&quot;: &quot;dataset_identifier&quot;</span>
<span class="s1">}</span>

<span class="s1">{</span>
<span class="s1">  &quot;backend&quot;: &quot;copernicusmarine&quot;,</span>
<span class="s1">  &quot;engine&quot;: &quot;custom_open_zarr.open_zarr&quot;,</span>
<span class="s1">  &quot;chunks&quot;: {&quot;time&quot;: 1}</span>
<span class="s1">}</span>
<span class="s1">                                         &#39;&#39;&#39;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;backgroundColor&quot;</span><span class="p">:</span> <span class="s2">&quot;#f8f9fa&quot;</span><span class="p">,</span> <span class="s2">&quot;padding&quot;</span><span class="p">:</span> <span class="s2">&quot;10px&quot;</span><span class="p">,</span> <span class="s2">&quot;borderRadius&quot;</span><span class="p">:</span> <span class="s2">&quot;4px&quot;</span><span class="p">}),</span>

                                        <span class="n">html</span><span class="o">.</span><span class="n">H6</span><span class="p">(</span><span class="s2">&quot;Notes:&quot;</span><span class="p">),</span>
                                        <span class="n">html</span><span class="o">.</span><span class="n">Ul</span><span class="p">([</span>
                                            <span class="n">html</span><span class="o">.</span><span class="n">Li</span><span class="p">(</span>
                                                <span class="s2">&quot;The &#39;backend&#39; field in JSON overrides the dropdown selection&quot;</span><span class="p">),</span>
                                            <span class="n">html</span><span class="o">.</span><span class="n">Li</span><span class="p">(</span>
                                                <span class="s2">&quot;For xarray: engine can be &#39;zarr&#39;, &#39;netcdf4&#39;&quot;</span><span class="p">),</span>
                                            <span class="n">html</span><span class="o">.</span><span class="n">Li</span><span class="p">(</span>
                                                <span class="s2">&quot;For Copernicus Marine: engine can be &#39;copernicusmarinetoolbox&#39; or &#39;custom_open_zarr.open_zarr&#39;&quot;</span><span class="p">),</span>
                                            <span class="n">html</span><span class="o">.</span><span class="n">Li</span><span class="p">(</span>
                                                <span class="s2">&quot;Additional parameters like chunks, decode_timedelta, s3 credentials can be included&quot;</span><span class="p">),</span>
                                            <span class="n">html</span><span class="o">.</span><span class="n">Li</span><span class="p">(</span>
                                                <span class="s2">&quot;All xarray parameters (chunks, decode_timedelta, etc.) can be passed through JSON&quot;</span><span class="p">),</span>
                                            <span class="n">html</span><span class="o">.</span><span class="n">Li</span><span class="p">(</span>
                                                <span class="s2">&quot;Common xarray params: chunks, decode_cf, decode_timedelta, mask_and_scale, storage_options&quot;</span><span class="p">)</span>
                                        <span class="p">])</span>
                                    <span class="p">]),</span>
                                    <span class="n">dbc</span><span class="o">.</span><span class="n">ModalFooter</span><span class="p">(</span>
                                        <span class="n">dbc</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span>
                                            <span class="s2">&quot;Close&quot;</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="s2">&quot;close-help-modal&quot;</span><span class="p">,</span> <span class="n">className</span><span class="o">=</span><span class="s2">&quot;ms-auto&quot;</span><span class="p">)</span>
                                    <span class="p">)</span>
                                <span class="p">],</span> <span class="nb">id</span><span class="o">=</span><span class="s2">&quot;help-modal&quot;</span><span class="p">,</span> <span class="n">is_open</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
                            <span class="p">]),</span>
                            <span class="n">html</span><span class="o">.</span><span class="n">Br</span><span class="p">(),</span>
                            <span class="n">html</span><span class="o">.</span><span class="n">Br</span><span class="p">(),</span>
                            <span class="n">dbc</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="s1">&#39;Load Dataset&#39;</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="s1">&#39;load-dataset-button&#39;</span><span class="p">,</span>
                                       <span class="n">color</span><span class="o">=</span><span class="s1">&#39;primary&#39;</span><span class="p">,</span> <span class="n">n_clicks</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">className</span><span class="o">=</span><span class="s1">&#39;mb-2&#39;</span><span class="p">),</span>
                            <span class="n">dcc</span><span class="o">.</span><span class="n">Loading</span><span class="p">(</span><span class="n">html</span><span class="o">.</span><span class="n">Div</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="s1">&#39;load-status&#39;</span><span class="p">),</span>
                                        <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;default&#39;</span><span class="p">),</span>
                        <span class="p">])</span>
                    <span class="p">],</span> <span class="n">className</span><span class="o">=</span><span class="s1">&#39;mb-3&#39;</span><span class="p">),</span>
                <span class="p">],</span> <span class="n">width</span><span class="o">=</span><span class="mi">10</span><span class="p">),</span>
                <span class="n">dbc</span><span class="o">.</span><span class="n">Col</span><span class="p">([</span>
                    <span class="n">dbc</span><span class="o">.</span><span class="n">Card</span><span class="p">([</span>
                        <span class="n">dbc</span><span class="o">.</span><span class="n">CardHeader</span><span class="p">(</span><span class="s2">&quot;Variable Selection&quot;</span><span class="p">),</span>
                        <span class="n">dbc</span><span class="o">.</span><span class="n">CardBody</span><span class="p">([</span>
                            <span class="n">dcc</span><span class="o">.</span><span class="n">Dropdown</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="s1">&#39;variable-dropdown&#39;</span><span class="p">,</span>
                                         <span class="n">style</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;width&#39;</span><span class="p">:</span> <span class="s1">&#39;100%&#39;</span><span class="p">}),</span>
                        <span class="p">])</span>
                    <span class="p">],</span> <span class="n">className</span><span class="o">=</span><span class="s1">&#39;mb-3&#39;</span><span class="p">),</span>
                <span class="p">],</span> <span class="n">width</span><span class="o">=</span><span class="mi">6</span><span class="p">),</span>
            <span class="p">]),</span>
            <span class="c1"># Second row: Dimension Selection</span>
            <span class="n">dbc</span><span class="o">.</span><span class="n">Row</span><span class="p">([</span>
                <span class="n">dbc</span><span class="o">.</span><span class="n">Col</span><span class="p">([</span>
                    <span class="n">dbc</span><span class="o">.</span><span class="n">Card</span><span class="p">([</span>
                        <span class="n">dbc</span><span class="o">.</span><span class="n">CardHeader</span><span class="p">(</span><span class="s2">&quot;Dimension Selection&quot;</span><span class="p">),</span>
                        <span class="n">dbc</span><span class="o">.</span><span class="n">CardBody</span><span class="p">([</span>
                            <span class="n">html</span><span class="o">.</span><span class="n">Div</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="s1">&#39;dimension-checklist-container&#39;</span><span class="p">),</span>
                            <span class="n">html</span><span class="o">.</span><span class="n">Div</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="s1">&#39;dimension-dropdowns-container&#39;</span><span class="p">),</span>
                        <span class="p">])</span>
                    <span class="p">],</span> <span class="n">className</span><span class="o">=</span><span class="s1">&#39;mb-3&#39;</span><span class="p">),</span>
                <span class="p">],</span> <span class="n">width</span><span class="o">=</span><span class="mi">12</span><span class="p">),</span>
            <span class="p">]),</span>
            <span class="c1"># Third row: Select Data (filter and button)</span>
            <span class="n">dbc</span><span class="o">.</span><span class="n">Row</span><span class="p">([</span>
                <span class="n">dbc</span><span class="o">.</span><span class="n">Col</span><span class="p">([</span>
                    <span class="n">dbc</span><span class="o">.</span><span class="n">Card</span><span class="p">([</span>
                        <span class="n">dbc</span><span class="o">.</span><span class="n">CardHeader</span><span class="p">(</span><span class="s2">&quot;Select Data&quot;</span><span class="p">),</span>
                        <span class="n">dbc</span><span class="o">.</span><span class="n">CardBody</span><span class="p">([</span>
                            <span class="n">html</span><span class="o">.</span><span class="n">Div</span><span class="p">([</span>
                                <span class="n">html</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="s2">&quot;Data Filter (Min/Max):&quot;</span><span class="p">,</span>
                                           <span class="n">className</span><span class="o">=</span><span class="s2">&quot;mb-1&quot;</span><span class="p">),</span>
                                <span class="n">dbc</span><span class="o">.</span><span class="n">Input</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="s1">&#39;data-filter-min&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;number&#39;</span><span class="p">,</span> <span class="n">placeholder</span><span class="o">=</span><span class="s1">&#39;Min value&#39;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="p">{</span>
                                          <span class="s1">&#39;width&#39;</span><span class="p">:</span> <span class="s1">&#39;45%&#39;</span><span class="p">,</span> <span class="s1">&#39;display&#39;</span><span class="p">:</span> <span class="s1">&#39;inline-block&#39;</span><span class="p">,</span> <span class="s1">&#39;marginRight&#39;</span><span class="p">:</span> <span class="s1">&#39;10px&#39;</span><span class="p">}),</span>
                                <span class="n">dbc</span><span class="o">.</span><span class="n">Input</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="s1">&#39;data-filter-max&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;number&#39;</span><span class="p">,</span> <span class="n">placeholder</span><span class="o">=</span><span class="s1">&#39;Max value&#39;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="p">{</span>
                                          <span class="s1">&#39;width&#39;</span><span class="p">:</span> <span class="s1">&#39;45%&#39;</span><span class="p">,</span> <span class="s1">&#39;display&#39;</span><span class="p">:</span> <span class="s1">&#39;inline-block&#39;</span><span class="p">}),</span>
                            <span class="p">],</span> <span class="n">className</span><span class="o">=</span><span class="s1">&#39;mb-2&#39;</span><span class="p">),</span>
                            <span class="n">dbc</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="s1">&#39;Show Data Quick Stats (Max/Min/Med/Stdev)&#39;</span><span class="p">,</span>
                                       <span class="nb">id</span><span class="o">=</span><span class="s1">&#39;show-data-button&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;info&#39;</span><span class="p">,</span> <span class="n">n_clicks</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">className</span><span class="o">=</span><span class="s1">&#39;mt-2&#39;</span><span class="p">),</span>
                        <span class="p">])</span>
                    <span class="p">],</span> <span class="n">className</span><span class="o">=</span><span class="s1">&#39;mb-3&#39;</span><span class="p">),</span>
                <span class="p">],</span> <span class="n">width</span><span class="o">=</span><span class="mi">12</span><span class="p">),</span>
            <span class="p">]),</span>
            <span class="c1"># Fourth row: Quick Stats</span>
            <span class="n">dbc</span><span class="o">.</span><span class="n">Row</span><span class="p">([</span>
                <span class="n">dbc</span><span class="o">.</span><span class="n">Col</span><span class="p">([</span>
                    <span class="n">dbc</span><span class="o">.</span><span class="n">Card</span><span class="p">([</span>
                        <span class="n">dbc</span><span class="o">.</span><span class="n">CardHeader</span><span class="p">(</span><span class="s2">&quot;Quick Stats (Max/Min/Mean/Med/STDEV)&quot;</span><span class="p">),</span>
                        <span class="n">dbc</span><span class="o">.</span><span class="n">CardBody</span><span class="p">([</span>
                            <span class="n">dcc</span><span class="o">.</span><span class="n">Loading</span><span class="p">(</span>
                                <span class="n">html</span><span class="o">.</span><span class="n">Div</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="s1">&#39;data-array-display&#39;</span><span class="p">),</span> <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;circle&#39;</span><span class="p">),</span>
                        <span class="p">])</span>
                    <span class="p">],</span> <span class="n">className</span><span class="o">=</span><span class="s1">&#39;mb-3&#39;</span><span class="p">),</span>
                <span class="p">],</span> <span class="n">width</span><span class="o">=</span><span class="mi">12</span><span class="p">),</span>
            <span class="p">]),</span>
            <span class="c1"># Fifth row: Plot Selected Data (full width)</span>
            <span class="n">dbc</span><span class="o">.</span><span class="n">Row</span><span class="p">([</span>
                <span class="n">dbc</span><span class="o">.</span><span class="n">Col</span><span class="p">([</span>
                    <span class="n">dbc</span><span class="o">.</span><span class="n">Card</span><span class="p">([</span>
                        <span class="n">dbc</span><span class="o">.</span><span class="n">CardHeader</span><span class="p">(</span><span class="s2">&quot;Plot Selected Data&quot;</span><span class="p">),</span>
                        <span class="n">dbc</span><span class="o">.</span><span class="n">CardBody</span><span class="p">([</span>
                            <span class="n">dcc</span><span class="o">.</span><span class="n">Loading</span><span class="p">(</span><span class="n">html</span><span class="o">.</span><span class="n">Div</span><span class="p">([</span>
                                <span class="n">html</span><span class="o">.</span><span class="n">Div</span><span class="p">(</span>
                                    <span class="nb">id</span><span class="o">=</span><span class="s1">&#39;map-container&#39;</span><span class="p">,</span> <span class="n">children</span><span class="o">=</span><span class="p">[</span><span class="n">html</span><span class="o">.</span><span class="n">Img</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="s1">&#39;map&#39;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;width&#39;</span><span class="p">:</span> <span class="s1">&#39;100%&#39;</span><span class="p">,</span> <span class="s1">&#39;height&#39;</span><span class="p">:</span> <span class="s1">&#39;auto&#39;</span><span class="p">})]),</span>
                            <span class="p">]),</span> <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;circle&#39;</span><span class="p">),</span>

                            <span class="n">dbc</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="s1">&#39;Extract Image&#39;</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="s1">&#39;extract-plot-button&#39;</span><span class="p">,</span>
                                       <span class="n">color</span><span class="o">=</span><span class="s1">&#39;success&#39;</span><span class="p">,</span> <span class="n">n_clicks</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">className</span><span class="o">=</span><span class="s1">&#39;mt-2&#39;</span><span class="p">),</span>
                        <span class="p">])</span>
                    <span class="p">]),</span>
                <span class="p">],</span> <span class="n">width</span><span class="o">=</span><span class="mi">12</span><span class="p">),</span>
            <span class="p">]),</span>
            <span class="c1"># Sixth row: Raster Image Display (full width)</span>
            <span class="n">dbc</span><span class="o">.</span><span class="n">Row</span><span class="p">([</span>
                <span class="n">dbc</span><span class="o">.</span><span class="n">Col</span><span class="p">([</span>
                    <span class="n">dbc</span><span class="o">.</span><span class="n">Card</span><span class="p">([</span>
                        <span class="n">dbc</span><span class="o">.</span><span class="n">CardHeader</span><span class="p">(</span><span class="s2">&quot;Generated Raster Image&quot;</span><span class="p">),</span>
                        <span class="n">dbc</span><span class="o">.</span><span class="n">CardBody</span><span class="p">([</span>
                            <span class="n">html</span><span class="o">.</span><span class="n">Div</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="s1">&#39;raster-container&#39;</span><span class="p">,</span> <span class="n">children</span><span class="o">=</span><span class="p">[</span>
                                <span class="n">html</span><span class="o">.</span><span class="n">P</span><span class="p">(</span><span class="s2">&quot;Click &#39;Extract Image&#39; to generate a raster image&quot;</span><span class="p">,</span>
                                       <span class="n">className</span><span class="o">=</span><span class="s2">&quot;text-muted text-center&quot;</span><span class="p">)</span>
                            <span class="p">])</span>
                        <span class="p">])</span>
                    <span class="p">]),</span>
                <span class="p">],</span> <span class="n">width</span><span class="o">=</span><span class="mi">12</span><span class="p">),</span>
            <span class="p">]),</span>
            <span class="c1"># Metadata row: full width at the bottom</span>
            <span class="n">dbc</span><span class="o">.</span><span class="n">Row</span><span class="p">([</span>
                <span class="n">dbc</span><span class="o">.</span><span class="n">Col</span><span class="p">([</span>
                    <span class="n">html</span><span class="o">.</span><span class="n">Div</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="s1">&#39;dataset-info-container&#39;</span><span class="p">,</span> <span class="n">className</span><span class="o">=</span><span class="s1">&#39;mt-3&#39;</span><span class="p">),</span>
                <span class="p">],</span> <span class="n">width</span><span class="o">=</span><span class="mi">12</span><span class="p">),</span>
            <span class="p">]),</span>
            <span class="c1"># Add a card for variable metadata display</span>
            <span class="n">dbc</span><span class="o">.</span><span class="n">Row</span><span class="p">([</span>
                <span class="n">dbc</span><span class="o">.</span><span class="n">Col</span><span class="p">([</span>
                    <span class="n">dbc</span><span class="o">.</span><span class="n">Card</span><span class="p">([</span>
                        <span class="n">dbc</span><span class="o">.</span><span class="n">CardHeader</span><span class="p">(</span><span class="s2">&quot;Variable Metadata&quot;</span><span class="p">),</span>
                        <span class="n">dbc</span><span class="o">.</span><span class="n">CardBody</span><span class="p">([</span>
                            <span class="n">html</span><span class="o">.</span><span class="n">Div</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="s1">&#39;variable-metadata-container&#39;</span><span class="p">)</span>
                        <span class="p">])</span>
                    <span class="p">],</span> <span class="n">className</span><span class="o">=</span><span class="s1">&#39;mb-3&#39;</span><span class="p">),</span>
                <span class="p">],</span> <span class="n">width</span><span class="o">=</span><span class="mi">12</span><span class="p">),</span>
            <span class="p">]),</span>
            <span class="c1"># Debug and logging row</span>
            <span class="n">dbc</span><span class="o">.</span><span class="n">Row</span><span class="p">([</span>
                <span class="n">dbc</span><span class="o">.</span><span class="n">Col</span><span class="p">([</span>
                    <span class="n">dbc</span><span class="o">.</span><span class="n">Card</span><span class="p">([</span>
                        <span class="n">dbc</span><span class="o">.</span><span class="n">CardHeader</span><span class="p">([</span>
                            <span class="s2">&quot;Debug Output &amp; Logs&quot;</span><span class="p">,</span>
                            <span class="n">dbc</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="s2">&quot;Clear Logs&quot;</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="s2">&quot;clear-logs-button&quot;</span><span class="p">,</span>
                                       <span class="n">color</span><span class="o">=</span><span class="s2">&quot;warning&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="s2">&quot;sm&quot;</span><span class="p">,</span> <span class="n">className</span><span class="o">=</span><span class="s2">&quot;float-end&quot;</span><span class="p">)</span>
                        <span class="p">]),</span>
                        <span class="n">dbc</span><span class="o">.</span><span class="n">CardBody</span><span class="p">([</span>
                            <span class="n">html</span><span class="o">.</span><span class="n">Div</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="s1">&#39;debug-output-container&#39;</span><span class="p">),</span>
                            <span class="n">html</span><span class="o">.</span><span class="n">Div</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="s1">&#39;logs-container&#39;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="p">{</span>
                                <span class="s1">&#39;backgroundColor&#39;</span><span class="p">:</span> <span class="s1">&#39;#f8f9fa&#39;</span><span class="p">,</span>
                                <span class="s1">&#39;border&#39;</span><span class="p">:</span> <span class="s1">&#39;1px solid #dee2e6&#39;</span><span class="p">,</span>
                                <span class="s1">&#39;borderRadius&#39;</span><span class="p">:</span> <span class="s1">&#39;4px&#39;</span><span class="p">,</span>
                                <span class="s1">&#39;padding&#39;</span><span class="p">:</span> <span class="s1">&#39;10px&#39;</span><span class="p">,</span>
                                <span class="s1">&#39;fontFamily&#39;</span><span class="p">:</span> <span class="s1">&#39;monospace&#39;</span><span class="p">,</span>
                                <span class="s1">&#39;fontSize&#39;</span><span class="p">:</span> <span class="s1">&#39;12px&#39;</span><span class="p">,</span>
                                <span class="s1">&#39;maxHeight&#39;</span><span class="p">:</span> <span class="s1">&#39;300px&#39;</span><span class="p">,</span>
                                <span class="s1">&#39;overflowY&#39;</span><span class="p">:</span> <span class="s1">&#39;auto&#39;</span><span class="p">,</span>
                                <span class="s1">&#39;whiteSpace&#39;</span><span class="p">:</span> <span class="s1">&#39;pre-wrap&#39;</span>
                            <span class="p">})</span>
                        <span class="p">])</span>
                    <span class="p">],</span> <span class="n">className</span><span class="o">=</span><span class="s1">&#39;mb-3&#39;</span><span class="p">),</span>
                <span class="p">],</span> <span class="n">width</span><span class="o">=</span><span class="mi">12</span><span class="p">),</span>
            <span class="p">]),</span>
            <span class="n">dcc</span><span class="o">.</span><span class="n">Store</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="s1">&#39;selected-dimensions-store&#39;</span><span class="p">),</span>
            <span class="n">html</span><span class="o">.</span><span class="n">Div</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="s1">&#39;debug-output&#39;</span><span class="p">)</span>
        <span class="p">],</span> <span class="n">fluid</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="c1"># Register all callbacks at startup, using a getter for self.ds</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">variable_selection</span> <span class="o">=</span> <span class="n">VariableSelection</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">app</span><span class="p">,</span> <span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">ds</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">variable_selection</span><span class="o">.</span><span class="n">setup_callbacks</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dimension_selection</span> <span class="o">=</span> <span class="n">DimensionSelection</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">app</span><span class="p">,</span> <span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">ds</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dimension_selection</span><span class="o">.</span><span class="n">setup_callbacks</span><span class="p">()</span>

        <span class="c1"># Use the new unified DataManager for all data operations</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data_manager</span> <span class="o">=</span> <span class="n">DataManager</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">app</span><span class="p">,</span> <span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">ds</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data_manager</span><span class="o">.</span><span class="n">setup_callbacks</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">setup_callbacks</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_variable_dropdown</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setup_variable_metadata_callback</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setup_help_modal_callback</span><span class="p">()</span>

<div class="viewcode-block" id="ViewerApp.update_variable_dropdown">
<a class="viewcode-back" href="../api.html#main.ViewerApp.update_variable_dropdown">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">update_variable_dropdown</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># Update the variable dropdown to list all data variables</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ds</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="kn">from</span><span class="w"> </span><span class="nn">dash</span><span class="w"> </span><span class="kn">import</span> <span class="n">callback_context</span>
            <span class="n">options</span> <span class="o">=</span> <span class="p">[</span>
                <span class="p">{</span><span class="s2">&quot;label&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">var</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">ds</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;long_name&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">var</span><span class="p">)</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">,</span>
                 <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="n">var</span><span class="p">}</span>
                <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ds</span><span class="o">.</span><span class="n">data_vars</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
            <span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">app</span><span class="o">.</span><span class="n">callback_map</span><span class="p">[</span><span class="s1">&#39;variable-dropdown.value&#39;</span><span class="p">][</span><span class="s1">&#39;inputs&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;options&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">options</span></div>


<div class="viewcode-block" id="ViewerApp.get_metadata_summary">
<a class="viewcode-back" href="../api.html#main.ViewerApp.get_metadata_summary">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_metadata_summary</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ds</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;No dataset loaded.&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="nb">vars</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ds</span><span class="o">.</span><span class="n">data_vars</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
            <span class="n">dims</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ds</span><span class="o">.</span><span class="n">dims</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
            <span class="n">attrs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ds</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
            <span class="c1"># Build a table of variables with their dimensions and CF attributes</span>
            <span class="n">var_rows</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="nb">vars</span><span class="p">:</span>
                <span class="n">v</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ds</span><span class="p">[</span><span class="n">var</span><span class="p">]</span>
                <span class="n">dims_str</span> <span class="o">=</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">d</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">v</span><span class="o">.</span><span class="n">sizes</span><span class="p">[</span><span class="n">d</span><span class="p">]</span><span class="si">}</span><span class="s2">)&quot;</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">v</span><span class="o">.</span><span class="n">dims</span><span class="p">])</span>
                <span class="n">long_name</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;long_name&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">)</span>
                <span class="n">standard_name</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;standard_name&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">)</span>
                <span class="n">grid_mapping</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;grid_mapping&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">)</span>
                <span class="n">var_rows</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">html</span><span class="o">.</span><span class="n">Tr</span><span class="p">([</span>
                    <span class="n">html</span><span class="o">.</span><span class="n">Td</span><span class="p">(</span><span class="n">var</span><span class="p">),</span>
                    <span class="n">html</span><span class="o">.</span><span class="n">Td</span><span class="p">(</span><span class="n">dims_str</span><span class="p">),</span>
                    <span class="n">html</span><span class="o">.</span><span class="n">Td</span><span class="p">(</span><span class="n">long_name</span><span class="p">),</span>
                    <span class="n">html</span><span class="o">.</span><span class="n">Td</span><span class="p">(</span><span class="n">standard_name</span><span class="p">),</span>
                    <span class="n">html</span><span class="o">.</span><span class="n">Td</span><span class="p">(</span><span class="n">grid_mapping</span><span class="p">)</span>
                <span class="p">]))</span>
            <span class="c1"># If grid mapping variable exists, show its attributes</span>
            <span class="n">grid_mapping_info</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="nb">vars</span><span class="p">:</span>
                <span class="n">v</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ds</span><span class="p">[</span><span class="n">var</span><span class="p">]</span>
                <span class="n">grid_mapping_name</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;grid_mapping&#39;</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">grid_mapping_name</span> <span class="ow">and</span> <span class="n">grid_mapping_name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ds</span><span class="p">:</span>
                    <span class="n">gm_var</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ds</span><span class="p">[</span><span class="n">grid_mapping_name</span><span class="p">]</span>
                    <span class="n">grid_mapping_info</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">html</span><span class="o">.</span><span class="n">Div</span><span class="p">([</span>
                        <span class="n">html</span><span class="o">.</span><span class="n">H6</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Grid Mapping: </span><span class="si">{</span><span class="n">grid_mapping_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">),</span>
                        <span class="n">html</span><span class="o">.</span><span class="n">Ul</span><span class="p">([</span>
                            <span class="n">html</span><span class="o">.</span><span class="n">Li</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">v</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">gm_var</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
                        <span class="p">])</span>
                    <span class="p">]))</span>
            <span class="c1"># Make dataset metadata div much neater and more readable</span>
            <span class="k">return</span> <span class="n">html</span><span class="o">.</span><span class="n">Div</span><span class="p">([</span>
                <span class="n">html</span><span class="o">.</span><span class="n">H5</span><span class="p">(</span><span class="s2">&quot;Dataset Metadata (CF Conventions)&quot;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="p">{</span>
                        <span class="s2">&quot;marginTop&quot;</span><span class="p">:</span> <span class="s2">&quot;10px&quot;</span><span class="p">,</span> <span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="s2">&quot;#222&quot;</span><span class="p">}),</span>
                <span class="n">html</span><span class="o">.</span><span class="n">Table</span><span class="p">([</span>
                    <span class="n">html</span><span class="o">.</span><span class="n">Thead</span><span class="p">(</span><span class="n">html</span><span class="o">.</span><span class="n">Tr</span><span class="p">([</span>
                        <span class="n">html</span><span class="o">.</span><span class="n">Th</span><span class="p">(</span><span class="s2">&quot;Variable&quot;</span><span class="p">),</span>
                        <span class="n">html</span><span class="o">.</span><span class="n">Th</span><span class="p">(</span><span class="s2">&quot;Dimensions&quot;</span><span class="p">),</span>
                        <span class="n">html</span><span class="o">.</span><span class="n">Th</span><span class="p">(</span><span class="s2">&quot;long_name&quot;</span><span class="p">),</span>
                        <span class="n">html</span><span class="o">.</span><span class="n">Th</span><span class="p">(</span><span class="s2">&quot;standard_name&quot;</span><span class="p">),</span>
                        <span class="n">html</span><span class="o">.</span><span class="n">Th</span><span class="p">(</span><span class="s2">&quot;grid_mapping&quot;</span><span class="p">)</span>
                    <span class="p">])),</span>
                    <span class="n">html</span><span class="o">.</span><span class="n">Tbody</span><span class="p">(</span><span class="n">var_rows</span><span class="p">)</span>
                <span class="p">],</span> <span class="nb">id</span><span class="o">=</span><span class="s2">&quot;dataset-info-table&quot;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;width&quot;</span><span class="p">:</span> <span class="s2">&quot;100%&quot;</span><span class="p">,</span> <span class="s2">&quot;fontSize&quot;</span><span class="p">:</span> <span class="s2">&quot;13px&quot;</span><span class="p">,</span> <span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="s2">&quot;#222&quot;</span><span class="p">,</span> <span class="s2">&quot;background&quot;</span><span class="p">:</span> <span class="s2">&quot;#fff&quot;</span><span class="p">,</span> <span class="s2">&quot;borderRadius&quot;</span><span class="p">:</span> <span class="s2">&quot;6px&quot;</span><span class="p">,</span> <span class="s2">&quot;padding&quot;</span><span class="p">:</span> <span class="s2">&quot;8px&quot;</span><span class="p">,</span> <span class="s2">&quot;marginBottom&quot;</span><span class="p">:</span> <span class="s2">&quot;16px&quot;</span><span class="p">}),</span>
                <span class="n">html</span><span class="o">.</span><span class="n">H6</span><span class="p">(</span><span class="s2">&quot;Global Attributes&quot;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="p">{</span>
                        <span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="s2">&quot;#222&quot;</span><span class="p">,</span> <span class="s2">&quot;marginTop&quot;</span><span class="p">:</span> <span class="s2">&quot;12px&quot;</span><span class="p">}),</span>
                <span class="n">html</span><span class="o">.</span><span class="n">Table</span><span class="p">([</span>
                    <span class="n">html</span><span class="o">.</span><span class="n">Tbody</span><span class="p">([</span>
                        <span class="n">html</span><span class="o">.</span><span class="n">Tr</span><span class="p">([</span>
                            <span class="n">html</span><span class="o">.</span><span class="n">Td</span><span class="p">(</span><span class="n">html</span><span class="o">.</span><span class="n">B</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)),</span> <span class="n">style</span><span class="o">=</span><span class="p">{</span>
                                    <span class="s2">&quot;paddingRight&quot;</span><span class="p">:</span> <span class="s2">&quot;8px&quot;</span><span class="p">}),</span>
                            <span class="n">html</span><span class="o">.</span><span class="n">Td</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">v</span><span class="p">))</span>
                        <span class="p">])</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">attrs</span>
                    <span class="p">])</span>
                <span class="p">],</span> <span class="n">style</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;fontSize&quot;</span><span class="p">:</span> <span class="s2">&quot;13px&quot;</span><span class="p">,</span> <span class="s2">&quot;background&quot;</span><span class="p">:</span> <span class="s2">&quot;#f8f9fa&quot;</span><span class="p">,</span> <span class="s2">&quot;borderRadius&quot;</span><span class="p">:</span> <span class="s2">&quot;6px&quot;</span><span class="p">,</span> <span class="s2">&quot;padding&quot;</span><span class="p">:</span> <span class="s2">&quot;8px&quot;</span><span class="p">,</span> <span class="s2">&quot;width&quot;</span><span class="p">:</span> <span class="s2">&quot;auto&quot;</span><span class="p">}),</span>
                <span class="o">*</span><span class="n">grid_mapping_info</span>
            <span class="p">],</span> <span class="n">className</span><span class="o">=</span><span class="s2">&quot;dataset-info-container&quot;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;background&quot;</span><span class="p">:</span> <span class="s2">&quot;#fff&quot;</span><span class="p">,</span> <span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="s2">&quot;#222&quot;</span><span class="p">,</span> <span class="s2">&quot;borderRadius&quot;</span><span class="p">:</span> <span class="s2">&quot;8px&quot;</span><span class="p">,</span> <span class="s2">&quot;padding&quot;</span><span class="p">:</span> <span class="s2">&quot;16px&quot;</span><span class="p">,</span> <span class="s2">&quot;marginBottom&quot;</span><span class="p">:</span> <span class="s2">&quot;16px&quot;</span><span class="p">,</span> <span class="s2">&quot;boxShadow&quot;</span><span class="p">:</span> <span class="s2">&quot;0 2px 8px rgba(0,0,0,0.04)&quot;</span><span class="p">})</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;Error reading metadata: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span></div>


<div class="viewcode-block" id="ViewerApp.setup_help_modal_callback">
<a class="viewcode-back" href="../api.html#main.ViewerApp.setup_help_modal_callback">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">setup_help_modal_callback</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nd">@self</span><span class="o">.</span><span class="n">app</span><span class="o">.</span><span class="n">callback</span><span class="p">(</span>
            <span class="n">Output</span><span class="p">(</span><span class="s2">&quot;help-modal&quot;</span><span class="p">,</span> <span class="s2">&quot;is_open&quot;</span><span class="p">),</span>
            <span class="p">[</span><span class="n">Input</span><span class="p">(</span><span class="s2">&quot;help-link&quot;</span><span class="p">,</span> <span class="s2">&quot;n_clicks&quot;</span><span class="p">),</span>
             <span class="n">Input</span><span class="p">(</span><span class="s2">&quot;close-help-modal&quot;</span><span class="p">,</span> <span class="s2">&quot;n_clicks&quot;</span><span class="p">)],</span>
            <span class="p">[</span><span class="n">State</span><span class="p">(</span><span class="s2">&quot;help-modal&quot;</span><span class="p">,</span> <span class="s2">&quot;is_open&quot;</span><span class="p">)],</span>
            <span class="n">prevent_initial_call</span><span class="o">=</span><span class="kc">True</span>
        <span class="p">)</span>
        <span class="k">def</span><span class="w"> </span><span class="nf">toggle_help_modal</span><span class="p">(</span><span class="n">n1</span><span class="p">,</span> <span class="n">n2</span><span class="p">,</span> <span class="n">is_open</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">n1</span> <span class="ow">or</span> <span class="n">n2</span><span class="p">:</span>
                <span class="k">return</span> <span class="ow">not</span> <span class="n">is_open</span>
            <span class="k">return</span> <span class="n">is_open</span></div>


<div class="viewcode-block" id="ViewerApp.setup_callbacks">
<a class="viewcode-back" href="../api.html#main.ViewerApp.setup_callbacks">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">setup_callbacks</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nd">@self</span><span class="o">.</span><span class="n">app</span><span class="o">.</span><span class="n">callback</span><span class="p">(</span>
            <span class="p">[</span><span class="n">Output</span><span class="p">(</span><span class="s1">&#39;load-status&#39;</span><span class="p">,</span> <span class="s1">&#39;children&#39;</span><span class="p">),</span>
             <span class="n">Output</span><span class="p">(</span><span class="s1">&#39;dataset-info-container&#39;</span><span class="p">,</span> <span class="s1">&#39;children&#39;</span><span class="p">),</span>
             <span class="n">Output</span><span class="p">(</span><span class="s1">&#39;logs-container&#39;</span><span class="p">,</span> <span class="s1">&#39;children&#39;</span><span class="p">)],</span>
            <span class="p">[</span><span class="n">Input</span><span class="p">(</span><span class="s1">&#39;load-dataset-button&#39;</span><span class="p">,</span> <span class="s1">&#39;n_clicks&#39;</span><span class="p">),</span>
             <span class="n">Input</span><span class="p">(</span><span class="s1">&#39;clear-logs-button&#39;</span><span class="p">,</span> <span class="s1">&#39;n_clicks&#39;</span><span class="p">)],</span>
            <span class="p">[</span><span class="n">State</span><span class="p">(</span><span class="s1">&#39;dataset-dropdown&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">),</span>
             <span class="n">State</span><span class="p">(</span><span class="s1">&#39;dataset-url-input&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">),</span>
             <span class="n">State</span><span class="p">(</span><span class="s1">&#39;backend-dropdown&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">),</span>
             <span class="n">State</span><span class="p">(</span><span class="s1">&#39;additional-params-input&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">)],</span>
            <span class="n">prevent_initial_call</span><span class="o">=</span><span class="kc">True</span>
        <span class="p">)</span>
        <span class="k">def</span><span class="w"> </span><span class="nf">handle_dataset_operations</span><span class="p">(</span><span class="n">load_clicks</span><span class="p">,</span> <span class="n">clear_clicks</span><span class="p">,</span> <span class="n">dropdown_url</span><span class="p">,</span> <span class="n">custom_url</span><span class="p">,</span> <span class="n">backend</span><span class="p">,</span> <span class="n">additional_params</span><span class="p">):</span>
            <span class="c1"># Determine which button was clicked</span>
            <span class="n">ctx</span> <span class="o">=</span> <span class="n">callback_context</span>
            <span class="k">if</span> <span class="n">ctx</span><span class="o">.</span><span class="n">triggered</span><span class="p">:</span>
                <span class="n">triggered_id</span> <span class="o">=</span> <span class="n">ctx</span><span class="o">.</span><span class="n">triggered</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;prop_id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">triggered_id</span> <span class="o">=</span> <span class="kc">None</span>

            <span class="k">if</span> <span class="n">triggered_id</span> <span class="o">==</span> <span class="s1">&#39;clear-logs-button&#39;</span><span class="p">:</span>
                <span class="c1"># Clear logs operation</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">dataset_loader</span><span class="o">.</span><span class="n">clear_logs</span><span class="p">()</span>
                <span class="k">return</span> <span class="n">dash</span><span class="o">.</span><span class="n">no_update</span><span class="p">,</span> <span class="n">dash</span><span class="o">.</span><span class="n">no_update</span><span class="p">,</span> <span class="s2">&quot;Logs cleared.&quot;</span>

            <span class="k">elif</span> <span class="n">triggered_id</span> <span class="o">==</span> <span class="s1">&#39;load-dataset-button&#39;</span><span class="p">:</span>
                <span class="c1"># Load dataset operation</span>
                <span class="c1"># Use dropdown selection if available, otherwise use custom input</span>
                <span class="n">url</span> <span class="o">=</span> <span class="n">dropdown_url</span> <span class="k">if</span> <span class="n">dropdown_url</span> <span class="k">else</span> <span class="n">custom_url</span>

                <span class="k">if</span> <span class="ow">not</span> <span class="n">url</span><span class="p">:</span>
                    <span class="k">return</span> <span class="s2">&quot;Please select a dataset from the list or enter a custom URL.&quot;</span><span class="p">,</span> <span class="n">dash</span><span class="o">.</span><span class="n">no_update</span><span class="p">,</span> <span class="n">dash</span><span class="o">.</span><span class="n">no_update</span>

                <span class="c1"># Parse additional parameters</span>
                <span class="n">kwargs</span> <span class="o">=</span> <span class="p">{}</span>
                <span class="k">if</span> <span class="n">additional_params</span> <span class="ow">and</span> <span class="n">additional_params</span><span class="o">.</span><span class="n">strip</span><span class="p">():</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="kn">import</span><span class="w"> </span><span class="nn">json</span>
                        <span class="n">kwargs</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">additional_params</span><span class="p">)</span>
                    <span class="k">except</span> <span class="n">json</span><span class="o">.</span><span class="n">JSONDecodeError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;Invalid JSON in backend args: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">dash</span><span class="o">.</span><span class="n">no_update</span><span class="p">,</span> <span class="n">dash</span><span class="o">.</span><span class="n">no_update</span>

                <span class="c1"># Parse JSON configuration</span>
                <span class="n">config</span> <span class="o">=</span> <span class="p">{}</span>
                <span class="k">if</span> <span class="n">additional_params</span> <span class="ow">and</span> <span class="n">additional_params</span><span class="o">.</span><span class="n">strip</span><span class="p">():</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="kn">import</span><span class="w"> </span><span class="nn">json</span>
                        <span class="n">config</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">additional_params</span><span class="p">)</span>
                    <span class="k">except</span> <span class="n">json</span><span class="o">.</span><span class="n">JSONDecodeError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;Invalid JSON in backend args: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">dash</span><span class="o">.</span><span class="n">no_update</span><span class="p">,</span> <span class="n">dash</span><span class="o">.</span><span class="n">no_update</span>

                <span class="c1"># If no backend specified in JSON, use dropdown selection</span>
                <span class="k">if</span> <span class="s1">&#39;backend&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">config</span> <span class="ow">and</span> <span class="n">backend</span> <span class="o">!=</span> <span class="s2">&quot;auto&quot;</span><span class="p">:</span>
                    <span class="n">config</span><span class="p">[</span><span class="s1">&#39;backend&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">backend</span>

                <span class="c1"># Show loading spinner automatically via dcc.Loading</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">dataseturl</span> <span class="o">=</span> <span class="n">url</span>

                <span class="c1"># Load dataset with enhanced error handling</span>
                <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataset_loader</span><span class="o">.</span><span class="n">load_dataset</span><span class="p">(</span>
                    <span class="n">url</span><span class="p">,</span> <span class="o">**</span><span class="n">config</span><span class="p">)</span>

                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ds</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataset_engine</span> <span class="o">=</span> <span class="n">result</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ds</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="n">error_msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Failed to load dataset from </span><span class="si">{</span><span class="n">url</span><span class="si">}</span><span class="s2">. Error: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">dataset_engine</span><span class="si">}</span><span class="s2">&quot;</span>
                        <span class="k">return</span> <span class="n">error_msg</span><span class="p">,</span> <span class="n">dash</span><span class="o">.</span><span class="n">no_update</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataset_loader</span><span class="o">.</span><span class="n">get_logs</span><span class="p">()</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">success_msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Successfully loaded dataset from </span><span class="si">{</span><span class="n">url</span><span class="si">}</span><span class="s2"> using </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">dataset_engine</span><span class="si">}</span><span class="s2">&quot;</span>
                        <span class="k">return</span> <span class="n">success_msg</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata_summary</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataset_loader</span><span class="o">.</span><span class="n">get_logs</span><span class="p">()</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;Unexpected result from dataset loader: </span><span class="si">{</span><span class="n">result</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">dash</span><span class="o">.</span><span class="n">no_update</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataset_loader</span><span class="o">.</span><span class="n">get_logs</span><span class="p">()</span>

            <span class="c1"># Default case - shouldn&#39;t happen</span>
            <span class="k">return</span> <span class="n">dash</span><span class="o">.</span><span class="n">no_update</span><span class="p">,</span> <span class="n">dash</span><span class="o">.</span><span class="n">no_update</span><span class="p">,</span> <span class="n">dash</span><span class="o">.</span><span class="n">no_update</span></div>


<div class="viewcode-block" id="ViewerApp.setup_variable_metadata_callback">
<a class="viewcode-back" href="../api.html#main.ViewerApp.setup_variable_metadata_callback">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">setup_variable_metadata_callback</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nd">@self</span><span class="o">.</span><span class="n">app</span><span class="o">.</span><span class="n">callback</span><span class="p">(</span>
            <span class="n">Output</span><span class="p">(</span><span class="s1">&#39;variable-metadata-container&#39;</span><span class="p">,</span> <span class="s1">&#39;children&#39;</span><span class="p">),</span>
            <span class="n">Input</span><span class="p">(</span><span class="s1">&#39;variable-dropdown&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="k">def</span><span class="w"> </span><span class="nf">update_variable_metadata</span><span class="p">(</span><span class="n">selected_var</span><span class="p">):</span>
            <span class="n">ds</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ds</span>
            <span class="k">if</span> <span class="n">ds</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">selected_var</span> <span class="ow">or</span> <span class="n">selected_var</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">ds</span><span class="p">:</span>
                <span class="k">return</span> <span class="s2">&quot;No variable selected.&quot;</span>
            <span class="n">v</span> <span class="o">=</span> <span class="n">ds</span><span class="p">[</span><span class="n">selected_var</span><span class="p">]</span>
            <span class="c1"># Attributes (show all, including long_name, units, etc.)</span>
            <span class="n">attr_items</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">vv</span> <span class="ow">in</span> <span class="n">v</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">attr_items</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">html</span><span class="o">.</span><span class="n">Tr</span><span class="p">([</span>
                    <span class="n">html</span><span class="o">.</span><span class="n">Td</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">),</span> <span class="n">style</span><span class="o">=</span><span class="p">{</span>
                            <span class="s2">&quot;fontWeight&quot;</span><span class="p">:</span> <span class="s2">&quot;bold&quot;</span><span class="p">,</span> <span class="s2">&quot;paddingRight&quot;</span><span class="p">:</span> <span class="s2">&quot;8px&quot;</span><span class="p">}),</span>
                    <span class="n">html</span><span class="o">.</span><span class="n">Td</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">vv</span><span class="p">))</span>
                <span class="p">]))</span>
            <span class="n">attr_table</span> <span class="o">=</span> <span class="n">html</span><span class="o">.</span><span class="n">Table</span><span class="p">([</span>
                <span class="n">html</span><span class="o">.</span><span class="n">Tbody</span><span class="p">(</span><span class="n">attr_items</span><span class="p">)</span>
            <span class="p">],</span> <span class="n">style</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;fontSize&quot;</span><span class="p">:</span> <span class="s2">&quot;14px&quot;</span><span class="p">,</span> <span class="s2">&quot;marginBottom&quot;</span><span class="p">:</span> <span class="s2">&quot;12px&quot;</span><span class="p">,</span> <span class="s2">&quot;background&quot;</span><span class="p">:</span> <span class="s2">&quot;#f8f9fa&quot;</span><span class="p">,</span> <span class="s2">&quot;borderRadius&quot;</span><span class="p">:</span> <span class="s2">&quot;6px&quot;</span><span class="p">,</span> <span class="s2">&quot;padding&quot;</span><span class="p">:</span> <span class="s2">&quot;8px&quot;</span><span class="p">,</span> <span class="s2">&quot;width&quot;</span><span class="p">:</span> <span class="s2">&quot;auto&quot;</span><span class="p">})</span>
            <span class="c1"># Dimensions (use .sizes for mapping from name to length)</span>
            <span class="n">dims</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">dims</span>
            <span class="n">dim_items</span> <span class="o">=</span> <span class="p">[</span><span class="n">html</span><span class="o">.</span><span class="n">Li</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">d</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">v</span><span class="o">.</span><span class="n">sizes</span><span class="p">[</span><span class="n">d</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">dims</span><span class="p">]</span>
            <span class="c1"># Coordinates (show preview values, handle loading errors, only load a small slice)</span>
            <span class="n">coord_items</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">v</span><span class="o">.</span><span class="n">coords</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">arr</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="n">c</span><span class="p">]</span><span class="o">.</span><span class="n">isel</span><span class="p">({</span><span class="n">d</span><span class="p">:</span> <span class="nb">slice</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
                                           <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">v</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="n">c</span><span class="p">]</span><span class="o">.</span><span class="n">dims</span><span class="p">})</span><span class="o">.</span><span class="n">values</span>
                    <span class="n">preview</span> <span class="o">=</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">arr</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                                        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">arr</span><span class="o">.</span><span class="n">size</span><span class="p">))])</span>
                    <span class="k">if</span> <span class="n">v</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="n">c</span><span class="p">]</span><span class="o">.</span><span class="n">sizes</span> <span class="ow">and</span> <span class="nb">list</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="n">c</span><span class="p">]</span><span class="o">.</span><span class="n">sizes</span><span class="o">.</span><span class="n">values</span><span class="p">())[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">5</span><span class="p">:</span>
                        <span class="n">preview</span> <span class="o">+=</span> <span class="s1">&#39;, ...&#39;</span>
                    <span class="n">coord_items</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">html</span><span class="o">.</span><span class="n">Li</span><span class="p">([</span>
                        <span class="n">html</span><span class="o">.</span><span class="n">B</span><span class="p">(</span>
                            <span class="n">c</span><span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;: [</span><span class="si">{</span><span class="n">preview</span><span class="si">}</span><span class="s2">] (size=</span><span class="si">{</span><span class="n">v</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="n">c</span><span class="p">]</span><span class="o">.</span><span class="n">sizes</span><span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="n">c</span><span class="p">]</span><span class="o">.</span><span class="n">sizes</span><span class="o">.</span><span class="n">keys</span><span class="p">())[</span><span class="mi">0</span><span class="p">]]</span><span class="si">}</span><span class="s2">)&quot;</span>
                    <span class="p">]))</span>
                <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                    <span class="n">coord_items</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">html</span><span class="o">.</span><span class="n">Li</span><span class="p">([</span>
                        <span class="n">html</span><span class="o">.</span><span class="n">B</span><span class="p">(</span><span class="n">c</span><span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;: [Error loading values: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">]&quot;</span>
                    <span class="p">]))</span>
            <span class="c1"># Grid mapping</span>
            <span class="n">grid_mapping_name</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;grid_mapping&#39;</span><span class="p">)</span>
            <span class="n">grid_mapping_info</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">if</span> <span class="n">grid_mapping_name</span> <span class="ow">and</span> <span class="n">grid_mapping_name</span> <span class="ow">in</span> <span class="n">ds</span><span class="p">:</span>
                <span class="n">gm_var</span> <span class="o">=</span> <span class="n">ds</span><span class="p">[</span><span class="n">grid_mapping_name</span><span class="p">]</span>
                <span class="n">grid_mapping_info</span> <span class="o">=</span> <span class="n">html</span><span class="o">.</span><span class="n">Div</span><span class="p">([</span>
                    <span class="n">html</span><span class="o">.</span><span class="n">H6</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Grid Mapping: </span><span class="si">{</span><span class="n">grid_mapping_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">),</span>
                    <span class="n">html</span><span class="o">.</span><span class="n">Ul</span><span class="p">([</span>
                        <span class="n">html</span><span class="o">.</span><span class="n">Li</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">vv</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">vv</span> <span class="ow">in</span> <span class="n">gm_var</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
                    <span class="p">])</span>
                <span class="p">])</span>
            <span class="k">return</span> <span class="n">html</span><span class="o">.</span><span class="n">Div</span><span class="p">([</span>
                <span class="n">html</span><span class="o">.</span><span class="n">H5</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Variable: </span><span class="si">{</span><span class="n">selected_var</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">),</span>
                <span class="n">html</span><span class="o">.</span><span class="n">H6</span><span class="p">(</span><span class="s2">&quot;Attributes:&quot;</span><span class="p">),</span>
                <span class="n">attr_table</span><span class="p">,</span>
                <span class="n">html</span><span class="o">.</span><span class="n">H6</span><span class="p">(</span><span class="s2">&quot;Dimensions:&quot;</span><span class="p">),</span>
                <span class="n">html</span><span class="o">.</span><span class="n">Ul</span><span class="p">(</span><span class="n">dim_items</span><span class="p">),</span>
                <span class="n">html</span><span class="o">.</span><span class="n">H6</span><span class="p">(</span><span class="s2">&quot;Coordinates (preview):&quot;</span><span class="p">),</span>
                <span class="n">html</span><span class="o">.</span><span class="n">Ul</span><span class="p">(</span><span class="n">coord_items</span><span class="p">),</span>
                <span class="n">grid_mapping_info</span> <span class="k">if</span> <span class="n">grid_mapping_info</span> <span class="k">else</span> <span class="kc">None</span>
            <span class="p">],</span> <span class="n">style</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;background&quot;</span><span class="p">:</span> <span class="s2">&quot;#fff&quot;</span><span class="p">,</span> <span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="s2">&quot;#222&quot;</span><span class="p">,</span> <span class="s2">&quot;borderRadius&quot;</span><span class="p">:</span> <span class="s2">&quot;8px&quot;</span><span class="p">,</span> <span class="s2">&quot;padding&quot;</span><span class="p">:</span> <span class="s2">&quot;16px&quot;</span><span class="p">,</span> <span class="s2">&quot;marginBottom&quot;</span><span class="p">:</span> <span class="s2">&quot;16px&quot;</span><span class="p">,</span> <span class="s2">&quot;boxShadow&quot;</span><span class="p">:</span> <span class="s2">&quot;0 2px 8px rgba(0,0,0,0.04)&quot;</span><span class="p">})</span></div>


<div class="viewcode-block" id="ViewerApp.run">
<a class="viewcode-back" href="../api.html#main.ViewerApp.run">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">app</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">debug</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">host</span><span class="o">=</span><span class="s1">&#39;0.0.0.0&#39;</span><span class="p">)</span></div>
</div>



<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">app</span> <span class="o">=</span> <span class="n">ViewerApp</span><span class="p">()</span>
    <span class="n">app</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright .</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>